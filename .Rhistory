library(limma)
library(TCGAbiolinks)
BiocManager::install('TCGAbiolinks')
sessionInfo()
library(TCGAbiolinks)
q()
setwd("~/A_Projects/BiGR/CC_vel")
library("reshape2")
library("ggplot2")
library("gplots")
#library("gProfileR")
library("gprofiler2")
library("ggrepel")
library("stringr")
library("ReactomeContentService4R")
source('R_scripts/CC_vel_R_functions.R')
#Get members of REAC of interest
# REAC_1<-event2Ids(event.id = "R-HSA-2500257")$geneSymbol#Resolution of Sister Chromatid Cohesion
# REAC_2<-event2Ids(event.id = "R-HSA-68877")$geneSymbol #Mitotic Prometaphase
# REAC_3<-event2Ids(event.id = "R-HSA-72613")$geneSymbol#Eukaryotic Translation Initiation
# REAC_4<-event2Ids(event.id = "R-HSA-2408557")$geneSymbol#Selenocysteine synthesis
# write.table(REAC_1,'Resolution_of_Sister_Chromatid_Cohesion.txt',row.names = F,quote = F, col.names =F)
# write.table(REAC_2,'Mitotic_Prometaphase.txt',row.names = F,quote = F, col.names =F)
# write.table(REAC_3,'Eukaryotic_Translation_Initiation.txt',row.names = F,quote = F, col.names =F)
# write.table(REAC_4,'Selenocysteine_synthesis.txt',row.names = F,quote = F, col.names =F)
cellcycle.rea <- getParticipants("R-HSA-1640170", retrieval = "EventsInPathways")
cellcycle.ids <- c("R-HSA-1640170", cellcycle.rea$stId)
HaCaT <- na.omit(read.table("data_files/data_results/rank/HaCat/A_B_t_test_results.csv", header=T, sep=","))
# HaCaT <- na.omit(read.table("analysis_results/thresh_0001/HaCat_0001_thresh.csv", header=T, sep=","))
HaCaT<-HaCaT[HaCaT$padjusted<0.01,]
phases <- c("G1", "S", "G2M")
# HaCat peak phase
go.results.peaks <- sapply(unique(na.omit(HaCaT$phase_peak_exp)), function(x) runProfiler2(as.character(HaCaT$gene_name[HaCaT$phase_peak_exp %in% x]), x, 0.05), simplify=F)
go.results.peaks.rea <- lapply(go.results.peaks, function(x) {x<-x[x$source %in% "REAC",]; x[order(x$p_value),]})
cc.r <- unique(unlist(lapply(go.results.peaks.rea, GetCCReactome)))
cc.top <- unique(na.omit(unlist(lapply(lapply(go.results.peaks.rea[phases], function(x) x[x$term_name %in% cc.r, ]), GetTopTerms, 10))))
ggsave("HaCat_reactome_CC_peak_exp.pdf", PlotTerms(go.results.peaks.rea[phases], cc.top), width=7.5, height=5)
top <- unique(unlist(lapply(go.results.peaks.rea, GetTopTerms, 10)))
ggsave("HaCat_reactome_peak_exp.pdf", PlotTerms(go.results.peaks.rea[phases], top), width=10, height=9)
source('R_scripts/CC_vel_R_functions.R')
ggsave("HaCat_reactome_peak_exp.pdf", PlotTerms(go.results.peaks.rea[phases], top), width=10, height=9)
source('R_scripts/CC_vel_R_functions.R')
ggsave("HaCat_reactome_peak_exp.pdf", PlotTerms(go.results.peaks.rea[phases], top), width=10, height=9)
source('R_scripts/CC_vel_R_functions.R')
ggsave("HaCat_reactome_CC_peak_exp.pdf", PlotTerms(go.results.peaks.rea[phases], cc.top), width=7.5, height=5)
ggsave("HaCat_reactome_peak_exp.pdf", PlotTerms(go.results.peaks.rea[phases], top), width=10, height=9)
#HaCaT Dynamic phases
HaCaT$DynPhase <- paste(HaCaT$phase_start_vel, HaCaT$phase_peak_vel, sep="\n")
go.results.dynphase_HaCaT <- sapply(unique(na.omit(HaCaT$DynPhase)), function(x) runProfiler2(as.character(HaCaT$gene_name[HaCaT$DynPhase %in% x]), x, 0.05), simplify=F)
go.results.dynphase.rea_HaCat <- lapply(go.results.dynphase_HaCaT, function(x) {x<-x[x$source %in% "REAC",]; x[order(x$p_value),]})
combPhases_HaCat <- paste(sapply(phases, rep, 3), phases, sep="\n")
top_HaCat <- unique(unlist(lapply(go.results.dynphase.rea_HaCat, GetTopTerms)))
ggsave("HaCat-DynPhases_reactome.pdf", PlotTerms(go.results.dynphase.rea_HaCat, top_HaCat, phases=combPhases_HaCat), width=12, height=10)
cc.r_HaCat <- unique(unlist(lapply(go.results.dynphase.rea_HaCat, GetCCReactome)))
cc.top_HaCat <- unique(na.omit(unlist(lapply(lapply(go.results.dynphase.rea_HaCat, function(x) x[x$term_name %in% cc.r_HaCat, ]), GetTopTerms, 10))))
ggsave("HaCat-DynPhases_reactome_CC.pdf", PlotTerms(go.results.dynphase.rea_HaCat, cc.top_HaCat, phases=combPhases_HaCat), width=9, height=7)
#Compare cell lines with peak expression
c293T <- na.omit(read.table("data_files/data_results/rank/293t/A_B_C_D_t_test_results.csv", header=T, sep=","))
# c293T <- na.omit(read.table("analysis_results/thresh_0001/293t_0001_thresh.csv", header=T, sep=","))
c293T<-c293T[c293T$padjusted<0.01,]
Jurkat <- na.omit(read.table("data_files/data_results/rank/jurkat/A_B_C_D_t_test_results.csv", header=T, sep=","))
# Jurkat <- na.omit(read.table("analysis_results/thresh_0001/jurkat_0001_thresh.csv", header=T, sep=","))
Jurkat<-Jurkat[Jurkat$padjusted<0.01,]
go.results.comb <-
lapply(list(HaCaT=HaCaT, "293T"=c293T, Jurkat=Jurkat),
function(cell) sapply(unique(na.omit(cell$phase_peak_exp)), function(x) runProfiler2(as.character(cell$gene_name[cell$phase_peak_exp %in% x]), x, 0.05), simplify=F))
go.results.comb.rea <- lapply(go.results.comb, function(res) lapply(res, function(x) {x<-x[x$source %in% "REAC",]; x[order(x$p_value),]}))
go.results.comb.bp <- lapply(go.results.comb, function(res) lapply(res, function(x) {x<-x[x$source %in% "GO:BP",]; x[order(x$p_value),]}))
cc.r2 <- unique(unlist(lapply(go.results.comb.rea, function(x) lapply(x, GetCCReactome))))
cc.top2 <- unique(na.omit(unlist(lapply(go.results.comb.rea, function(list) lapply(lapply(list[phases], function(x) x[x$term_name %in% cc.r2, ]), GetTopTerms, 10)))))
ggsave("All_reactome_CC_peak_exp.pdf", PlotTerms(go.results.comb.rea, na.omit(cc.top2), MeltProfiler2), width=10, height=6)
top2 <- unique(unlist(lapply(go.results.comb.rea, function(x) lapply(x, GetTopTerms, 10))))
ggsave("All_reactome_peak_exp_10.pdf", PlotTerms(go.results.comb.rea, na.omit(top2), MeltProfiler2), width=14, height=15)
top2 <- unique(unlist(lapply(go.results.comb.rea, function(x) lapply(x, GetTopTerms, 5))))
ggsave("All_reactome_peak_exp_5.pdf", PlotTerms(go.results.comb.rea, na.omit(top2), MeltProfiler2), width=11, height=12)
#Dependencies
setwd("~/A_Projects/BiGR/CC_vel")
library("reshape2")
library("ggplot2")
library("gplots")
#library("gProfileR")
library("gprofiler2")
library("ggrepel")
library("stringr")
library("ReactomeContentService4R")
source('R_scripts/CC_vel_R_functions.R')
#Get members of REAC of interest
# REAC_1<-event2Ids(event.id = "R-HSA-2500257")$geneSymbol#Resolution of Sister Chromatid Cohesion
# REAC_2<-event2Ids(event.id = "R-HSA-68877")$geneSymbol #Mitotic Prometaphase
# REAC_3<-event2Ids(event.id = "R-HSA-72613")$geneSymbol#Eukaryotic Translation Initiation
# REAC_4<-event2Ids(event.id = "R-HSA-2408557")$geneSymbol#Selenocysteine synthesis
# write.table(REAC_1,'Resolution_of_Sister_Chromatid_Cohesion.txt',row.names = F,quote = F, col.names =F)
# write.table(REAC_2,'Mitotic_Prometaphase.txt',row.names = F,quote = F, col.names =F)
# write.table(REAC_3,'Eukaryotic_Translation_Initiation.txt',row.names = F,quote = F, col.names =F)
# write.table(REAC_4,'Selenocysteine_synthesis.txt',row.names = F,quote = F, col.names =F)
cellcycle.rea <- getParticipants("R-HSA-1640170", retrieval = "EventsInPathways")
cellcycle.ids <- c("R-HSA-1640170", cellcycle.rea$stId)
# HaCaT <- na.omit(read.table("data_files/data_results/rank/HaCat/A_B_t_test_results.csv", header=T, sep=","))
HaCaT <- na.omit(read.table("analysis_results/thresh_0001/HaCat_0001_thresh.csv", header=T, sep=","))
HaCaT<-HaCaT[HaCaT$padjusted<0.01,]
phases <- c("G1", "S", "G2M")
# HaCat peak phase
go.results.peaks <- sapply(unique(na.omit(HaCaT$phase_peak_exp)), function(x) runProfiler2(as.character(HaCaT$gene_name[HaCaT$phase_peak_exp %in% x]), x, 0.05), simplify=F)
go.results.peaks.rea <- lapply(go.results.peaks, function(x) {x<-x[x$source %in% "REAC",]; x[order(x$p_value),]})
cc.r <- unique(unlist(lapply(go.results.peaks.rea, GetCCReactome)))
cc.top <- unique(na.omit(unlist(lapply(lapply(go.results.peaks.rea[phases], function(x) x[x$term_name %in% cc.r, ]), GetTopTerms, 10))))
ggsave("HaCat_reactome_CC_peak_exp.pdf", PlotTerms(go.results.peaks.rea[phases], cc.top), width=7.5, height=5)
top <- unique(unlist(lapply(go.results.peaks.rea, GetTopTerms, 10)))
ggsave("HaCat_reactome_peak_exp.pdf", PlotTerms(go.results.peaks.rea[phases], top), width=10, height=9)
#HaCaT Dynamic phases
HaCaT$DynPhase <- paste(HaCaT$phase_start_vel, HaCaT$phase_peak_vel, sep="\n")
go.results.dynphase_HaCaT <- sapply(unique(na.omit(HaCaT$DynPhase)), function(x) runProfiler2(as.character(HaCaT$gene_name[HaCaT$DynPhase %in% x]), x, 0.05), simplify=F)
#Compare cell lines with peak expression
# c293T <- na.omit(read.table("data_files/data_results/rank/293t/A_B_C_D_t_test_results.csv", header=T, sep=","))
c293T <- na.omit(read.table("analysis_results/thresh_0001/293t_0001_thresh.csv", header=T, sep=","))
c293T<-c293T[c293T$padjusted<0.01,]
# Jurkat <- na.omit(read.table("data_files/data_results/rank/jurkat/A_B_C_D_t_test_results.csv", header=T, sep=","))
Jurkat <- na.omit(read.table("analysis_results/thresh_0001/jurkat_0001_thresh.csv", header=T, sep=","))
Jurkat<-Jurkat[Jurkat$padjusted<0.01,]
go.results.comb <-
lapply(list(HaCaT=HaCaT, "293T"=c293T, Jurkat=Jurkat),
function(cell) sapply(unique(na.omit(cell$phase_peak_exp)), function(x) runProfiler2(as.character(cell$gene_name[cell$phase_peak_exp %in% x]), x, 0.05), simplify=F))
go.results.comb.rea <- lapply(go.results.comb, function(res) lapply(res, function(x) {x<-x[x$source %in% "REAC",]; x[order(x$p_value),]}))
go.results.comb.bp <- lapply(go.results.comb, function(res) lapply(res, function(x) {x<-x[x$source %in% "GO:BP",]; x[order(x$p_value),]}))
cc.r2 <- unique(unlist(lapply(go.results.comb.rea, function(x) lapply(x, GetCCReactome))))
cc.top2 <- unique(na.omit(unlist(lapply(go.results.comb.rea, function(list) lapply(lapply(list[phases], function(x) x[x$term_name %in% cc.r2, ]), GetTopTerms, 10)))))
ggsave("All_reactome_CC_peak_exp.pdf", PlotTerms(go.results.comb.rea, na.omit(cc.top2), MeltProfiler2), width=10, height=6)
top2 <- unique(unlist(lapply(go.results.comb.rea, function(x) lapply(x, GetTopTerms, 10))))
ggsave("All_reactome_peak_exp_10.pdf", PlotTerms(go.results.comb.rea, na.omit(top2), MeltProfiler2), width=14, height=15)
top2 <- unique(unlist(lapply(go.results.comb.rea, function(x) lapply(x, GetTopTerms, 5))))
ggsave("All_reactome_peak_exp_5.pdf", PlotTerms(go.results.comb.rea, na.omit(top2), MeltProfiler2), width=11, height=12)
#Dependencies
setwd("~/A_Projects/BiGR/CC_vel")
library("reshape2")
library("ggplot2")
library("gplots")
#library("gProfileR")
library("gprofiler2")
library("ggrepel")
library("stringr")
library("ReactomeContentService4R")
source('R_scripts/CC_vel_R_functions.R')
#Get members of REAC of interest
# REAC_1<-event2Ids(event.id = "R-HSA-2500257")$geneSymbol#Resolution of Sister Chromatid Cohesion
# REAC_2<-event2Ids(event.id = "R-HSA-68877")$geneSymbol #Mitotic Prometaphase
# REAC_3<-event2Ids(event.id = "R-HSA-72613")$geneSymbol#Eukaryotic Translation Initiation
# REAC_4<-event2Ids(event.id = "R-HSA-2408557")$geneSymbol#Selenocysteine synthesis
# write.table(REAC_1,'Resolution_of_Sister_Chromatid_Cohesion.txt',row.names = F,quote = F, col.names =F)
# write.table(REAC_2,'Mitotic_Prometaphase.txt',row.names = F,quote = F, col.names =F)
# write.table(REAC_3,'Eukaryotic_Translation_Initiation.txt',row.names = F,quote = F, col.names =F)
# write.table(REAC_4,'Selenocysteine_synthesis.txt',row.names = F,quote = F, col.names =F)
cellcycle.rea <- getParticipants("R-HSA-1640170", retrieval = "EventsInPathways")
cellcycle.ids <- c("R-HSA-1640170", cellcycle.rea$stId)
HaCaT <- na.omit(read.table("data_files/data_results/rank/HaCat/A_B_t_test_results.csv", header=T, sep=","))
# HaCaT <- na.omit(read.table("analysis_results/thresh_0001/HaCat_0001_thresh.csv", header=T, sep=","))
HaCaT<-HaCaT[HaCaT$padjusted<0.01,]
phases <- c("G1", "S", "G2M")
# HaCat peak phase
go.results.peaks <- sapply(unique(na.omit(HaCaT$phase_peak_exp)), function(x) runProfiler2(as.character(HaCaT$gene_name[HaCaT$phase_peak_exp %in% x]), x, 0.05), simplify=F)
go.results.peaks.rea <- lapply(go.results.peaks, function(x) {x<-x[x$source %in% "REAC",]; x[order(x$p_value),]})
cc.r <- unique(unlist(lapply(go.results.peaks.rea, GetCCReactome)))
cc.top <- unique(na.omit(unlist(lapply(lapply(go.results.peaks.rea[phases], function(x) x[x$term_name %in% cc.r, ]), GetTopTerms, 10))))
ggsave("HaCat_reactome_CC_peak_exp.pdf", PlotTerms(go.results.peaks.rea[phases], cc.top), width=7.5, height=5)
top <- unique(unlist(lapply(go.results.peaks.rea, GetTopTerms, 10)))
ggsave("HaCat_reactome_peak_exp.pdf", PlotTerms(go.results.peaks.rea[phases], top), width=10, height=9)
#HaCaT Dynamic phases
HaCaT$DynPhase <- paste(HaCaT$phase_start_vel, HaCaT$phase_peak_vel, sep="\n")
go.results.dynphase_HaCaT <- sapply(unique(na.omit(HaCaT$DynPhase)), function(x) runProfiler2(as.character(HaCaT$gene_name[HaCaT$DynPhase %in% x]), x, 0.05), simplify=F)
go.results.dynphase.rea_HaCat <- lapply(go.results.dynphase_HaCaT, function(x) {x<-x[x$source %in% "REAC",]; x[order(x$p_value),]})
combPhases_HaCat <- paste(sapply(phases, rep, 3), phases, sep="\n")
top_HaCat <- unique(unlist(lapply(go.results.dynphase.rea_HaCat, GetTopTerms)))
ggsave("HaCat-DynPhases_reactome.pdf", PlotTerms(go.results.dynphase.rea_HaCat, top_HaCat, phases=combPhases_HaCat), width=12, height=10)
cc.r_HaCat <- unique(unlist(lapply(go.results.dynphase.rea_HaCat, GetCCReactome)))
cc.top_HaCat <- unique(na.omit(unlist(lapply(lapply(go.results.dynphase.rea_HaCat, function(x) x[x$term_name %in% cc.r_HaCat, ]), GetTopTerms, 10))))
ggsave("HaCat-DynPhases_reactome_CC.pdf", PlotTerms(go.results.dynphase.rea_HaCat, cc.top_HaCat, phases=combPhases_HaCat), width=9, height=7)
#Compare cell lines with peak expression
c293T <- na.omit(read.table("data_files/data_results/rank/293t/A_B_C_D_t_test_results.csv", header=T, sep=","))
# c293T <- na.omit(read.table("analysis_results/thresh_0001/293t_0001_thresh.csv", header=T, sep=","))
c293T<-c293T[c293T$padjusted<0.01,]
Jurkat <- na.omit(read.table("data_files/data_results/rank/jurkat/A_B_C_D_t_test_results.csv", header=T, sep=","))
# Jurkat <- na.omit(read.table("analysis_results/thresh_0001/jurkat_0001_thresh.csv", header=T, sep=","))
Jurkat<-Jurkat[Jurkat$padjusted<0.01,]
go.results.comb <-
lapply(list(HaCaT=HaCaT, "293T"=c293T, Jurkat=Jurkat),
function(cell) sapply(unique(na.omit(cell$phase_peak_exp)), function(x) runProfiler2(as.character(cell$gene_name[cell$phase_peak_exp %in% x]), x, 0.05), simplify=F))
go.results.comb.rea <- lapply(go.results.comb, function(res) lapply(res, function(x) {x<-x[x$source %in% "REAC",]; x[order(x$p_value),]}))
go.results.comb.bp <- lapply(go.results.comb, function(res) lapply(res, function(x) {x<-x[x$source %in% "GO:BP",]; x[order(x$p_value),]}))
cc.r2 <- unique(unlist(lapply(go.results.comb.rea, function(x) lapply(x, GetCCReactome))))
cc.top2 <- unique(na.omit(unlist(lapply(go.results.comb.rea, function(list) lapply(lapply(list[phases], function(x) x[x$term_name %in% cc.r2, ]), GetTopTerms, 10)))))
ggsave("All_reactome_CC_peak_exp.pdf", PlotTerms(go.results.comb.rea, na.omit(cc.top2), MeltProfiler2), width=10, height=6)
top2 <- unique(unlist(lapply(go.results.comb.rea, function(x) lapply(x, GetTopTerms, 10))))
ggsave("All_reactome_peak_exp_10.pdf", PlotTerms(go.results.comb.rea, na.omit(top2), MeltProfiler2), width=14, height=15)
top2 <- unique(unlist(lapply(go.results.comb.rea, function(x) lapply(x, GetTopTerms, 5))))
ggsave("All_reactome_peak_exp_5.pdf", PlotTerms(go.results.comb.rea, na.omit(top2), MeltProfiler2), width=12, height=12)
